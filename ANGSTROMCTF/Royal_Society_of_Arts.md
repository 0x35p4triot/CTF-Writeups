# ``#RSA``   </a><img src="https://media.giphy.com/media/WUlplcMpOCEmTGBtBW/giphy.gif" width="30">

<a href="https://github.com/404"><img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" width="100%"></a>
- ![image](https://user-images.githubusercontent.com/127461439/233792408-80268200-9c8a-4093-ae29-f3e8d1b30ed1.png)
- Bài này cho ta file ``rsa.py`` và ``output.txt``
```
#rsa.py
from Crypto.Util.number import getStrongPrime, bytes_to_long
f = open("flag.txt").read()
m = bytes_to_long(f.encode())
p = getStrongPrime(512)
q = getStrongPrime(512)
n = p*q
e = 65537
c = pow(m,e,n)
print("n =",n)
print("e =",e)
print("c =",c)
print("(p-2)*(q-1) =", (p-2)*(q-1))
print("(p-1)*(q-2) =", (p-1)*(q-2))
```
```
#output.txt
n = 125152237161980107859596658891851084232065907177682165993300073587653109353529564397637482758441209445085460664497151026134819384539887509146955251284230158509195522123739130077725744091649212709410268449632822394998403777113982287135909401792915941770405800840172214125677106752311001755849804716850482011237
e = 65537
c = 40544832072726879770661606103417010618988078158535064967318135325645800905492733782556836821807067038917156891878646364780739241157067824416245546374568847937204678288252116089080688173934638564031950544806463980467254757125934359394683198190255474629179266277601987023393543376811412693043039558487983367289
(p-2)*(q-1) = 125152237161980107859596658891851084232065907177682165993300073587653109353529564397637482758441209445085460664497151026134819384539887509146955251284230125943565148141498300205893475242956903188936949934637477735897301870046234768439825644866543391610507164360506843171701976641285249754264159339017466738250
(p-1)*(q-2) = 125152237161980107859596658891851084232065907177682165993300073587653109353529564397637482758441209445085460664497151026134819384539887509146955251284230123577760657520479879758538312798938234126141096433998438004751495264208294710150161381066757910797946636886901614307738041629014360829994204066455759806614
```
- Nhìn định dạng của output thì mình nghĩ ngay tới tìm ``p`` và ``q``
- Đoạn code python này giải phương trình ``(p-2)*(q-1)`` và ``(p-1)*(q-2)`` để tìm ra ``p`` và ``q``
```
from sympy import symbols, Eq, solve

p, q = symbols('p q')                     # Khai báo biến p và q

# Khai báo phương trình 1
eq1 = Eq((p-2)*(q-1), 125152237161980107859596658891851084232065907177682165993300073587653109353529564397637482758441209445085460664497151026134819384539887509146955251284230125943565148141498300205893475242956903188936949934637477735897301870046234768439825644866543391610507164360506843171701976641285249754264159339017466738250)

# Khai báo phương trình 2
eq2 = Eq((p-1)*(q-2), 125152237161980107859596658891851084232065907177682165993300073587653109353529564397637482758441209445085460664497151026134819384539887509146955251284230123577760657520479879758538312798938234126141096433998438004751495264208294710150161381066757910797946636886901614307738041629014360829994204066455759806614)

solutions = solve((eq1, eq2), (p, q))     # Giải hệ phương trình

print("Các giá trị của p và q là:")       # In kết quả
for sol in solutions:
    print("p =", sol[0])
    print("q =", sol[1])
```
- Sau khi tìm được ``p`` và ``q`` thì mình dùng tool ``https://www.dcode.fr/rsa-cipher`` để tìm ra flag (do ngại viết code)
- ![image](https://user-images.githubusercontent.com/127461439/233792947-04c6a807-02ad-416d-b494-0db7b1c93f6c.png)
- Vậy flag bài này là: actf{tw0_equ4ti0ns_in_tw0_unkn0wns_d62507431b7e7087}

<a href="https://github.com/404"><img src="https://user-images.githubusercontent.com/73097560/115834477-dbab4500-a447-11eb-908a-139a6edaec5c.gif" width="100%"></a>
